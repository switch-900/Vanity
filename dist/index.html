<!doctype html><html lang="en"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self'; base-uri 'none'; object-src 'none'; frame-ancestors 'none'; form-action 'none'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; worker-src blob:; connect-src 'self' https://ordinals.com; script-src 'self' 'sha256-H5A4u1Wzjci4iOV73AcGK+PlGu3JFuv4DyEVgKZmFjw='"><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport"><meta content="no-referrer" name="referrer"><meta content="geolocation=(), microphone=(), camera=(self), payment=(), usb=(), bluetooth=(), serial=(), midi=(), magnetometer=(), gyroscope=(), accelerometer=()" http-equiv="Permissions-Policy"><title>Address Creator</title><style>:root{color-scheme:dark;--bg:#070713;--bg2:#0b0a1c;--surface:rgba(255, 255, 255, 0.04);--surface2:rgba(255, 255, 255, 0.025);--line:rgba(255, 255, 255, 0.10);--text:rgba(255, 255, 255, 0.92);--muted:rgba(255, 255, 255, 0.65);--accent:#4be3ff;--accent2:#8a5cff;--warn:#ffcc66;--mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--sans:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}body,html{height:auto;min-height:100%;overflow-x:hidden;overflow-y:auto;font-family:var(--sans);color:var(--text);-webkit-font-smoothing:antialiased}body{background:radial-gradient(900px 520px at 15% 10%,rgba(75,227,255,.08),transparent 60%),radial-gradient(820px 520px at 90% 20%,rgba(138,92,255,.1),transparent 62%),linear-gradient(180deg,var(--bg2),var(--bg));position:relative}body::before{content:"";position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.22;background:radial-gradient(1200px 520px at 50% 0,rgba(75,227,255,.1),transparent 55%),repeating-linear-gradient(0deg,rgba(255,255,255,0) 0,rgba(255,255,255,0) 16px,rgba(75,227,255,.06) 17px),repeating-linear-gradient(90deg,rgba(255,255,255,0) 0,rgba(255,255,255,0) 22px,rgba(138,92,255,.05) 23px);mix-blend-mode:screen;filter:blur(.2px);animation:holoDrift 14s linear infinite}body::after{content:"";position:fixed;left:-10vw;right:-10vw;bottom:-26vh;height:60vh;pointer-events:none;z-index:0;opacity:.2;background:linear-gradient(180deg,transparent,rgba(0,0,0,.55)),repeating-linear-gradient(90deg,rgba(75,227,255,0) 0,rgba(75,227,255,0) 18px,rgba(75,227,255,.07) 19px),repeating-linear-gradient(0deg,rgba(138,92,255,0) 0,rgba(138,92,255,0) 18px,rgba(138,92,255,.06) 19px);transform-origin:bottom;transform:perspective(900px) rotateX(64deg) translateY(0);mask-image:radial-gradient(75% 90% at 50% 60%,black 55%,transparent 78%);mix-blend-mode:screen;animation:gridSlide 10s linear infinite}@keyframes holoDrift{0%{transform:translate3d(0,0,0)}50%{transform:translate3d(0,10px,0)}100%{transform:translate3d(0,0,0)}}@keyframes gridSlide{0%{background-position:0 0,0 0,0 0}100%{background-position:0 0,240px 0,0 240px}}.app{min-height:100vh;display:flex;flex-direction:column;position:relative;z-index:1}header{padding:clamp(16px,4vh,24px) 20px;text-align:center;flex-shrink:0}h1{font-size:clamp(24px, 5.5vw, 34px);font-weight:700;letter-spacing:-.02em;background:linear-gradient(135deg,rgba(255,255,255,.96) 0,rgba(255,255,255,.65) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:4px}.subtitle{font-size:clamp(13px, 3vw, 15px);color:var(--muted);font-weight:400}.content{flex:1;overflow:visible;padding:0 20px 20px;max-width:560px;margin:0 auto;width:100%;display:flex;flex-direction:column;gap:12px;min-height:0}.card{border-radius:16px;border:1px solid var(--line);background:linear-gradient(180deg,var(--surface),var(--surface2));box-shadow:0 18px 55px rgba(0,0,0,.55),inset 0 1px 0 rgba(255,255,255,.05);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);padding:clamp(16px,4vw,24px);margin-bottom:0}#statusCard{position:fixed;left:20px;right:20px;top:50%;transform:translateY(-50%);max-width:560px;margin:0 auto;z-index:20;max-height:80vh;overflow:hidden;display:flex;flex-direction:column;gap:12px}#statusBackdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:15}.step{margin-bottom:clamp(16px,4vh,24px)}.step:last-child{margin-bottom:0}.step-num{display:inline-flex;align-items:center;justify-content:center;width:24px;height:24px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:50%;font-size:13px;font-weight:700;margin-right:8px;flex:0 0 auto}.step-title{font-size:clamp(14px, 3.5vw, 16px);font-weight:600;margin-bottom:12px;display:flex;align-items:center}.helper{font-size:clamp(12px, 3vw, 13px);color:rgba(255,255,255,.55);margin-bottom:10px;line-height:1.4}.chars-compact{background:rgba(0,0,0,.18);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px;font-family:var(--mono);font-size:clamp(11px, 2.8vw, 13px);color:rgba(255,255,255,.68);letter-spacing:2px;text-align:center;line-height:1.6;word-break:break-all}.input-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}.input-row.single{grid-template-columns:1fr}.input-wrap{position:relative}label{display:block;font-size:clamp(11px, 2.8vw, 12px);font-weight:600;color:rgba(255,255,255,.72);margin-bottom:6px;text-transform:uppercase;letter-spacing:.05em}input,select,textarea{width:100%;background:rgba(0,0,0,.22);border:1px solid rgba(255,255,255,.14);border-radius:12px;padding:12px;font-family:var(--mono);font-size:clamp(13px, 3.2vw, 15px);color:rgba(255,255,255,.9);outline:0;transition:all .2s}select{background:rgba(0,0,0,.34);color:rgba(255,255,255,.94)}select option{background:var(--bg2);color:rgba(255,255,255,.94)}input:focus,select:focus,textarea:focus{background:rgba(0,0,0,.26);border-color:rgba(75,227,255,.45);box-shadow:0 0 0 3px rgba(75,227,255,.18)}input::placeholder{color:rgba(255,255,255,.3)}.preview{background:linear-gradient(135deg,rgba(75,227,255,.1),rgba(138,92,255,.08));border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:14px;margin:12px 0}.preview-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:rgba(255,255,255,.4);margin-bottom:6px}.preview-addr{font-family:var(--mono);font-size:clamp(11px, 2.8vw, 13px);line-height:1.5;word-break:break-all}.preview-addr .base{color:rgba(255,255,255,.3)}.preview-addr .prefix{color:var(--accent);font-weight:600}.preview-addr .suffix{color:var(--accent2);font-weight:600}.preview-addr .wild{color:rgba(255,255,255,.15)}.difficulty{display:flex;align-items:center;gap:10px;padding:10px 12px;background:rgba(0,0,0,.18);border-radius:10px;margin-top:12px}.diff-icon{font-size:18px}.diff-text{flex:1;font-size:clamp(12px, 3vw, 13px);color:rgba(255,255,255,.7)}.btn{width:100%;border:1px solid rgba(75,227,255,.45);background:linear-gradient(135deg,rgba(75,227,255,.22),rgba(138,92,255,.18));border-radius:12px;padding:clamp(14px,3.5vh,16px);font-size:clamp(14px, 3.5vw, 16px);font-weight:700;color:rgba(255,255,255,.94);cursor:pointer;transition:all .2s;box-shadow:0 10px 28px rgba(0,0,0,.35)}.btn:active{transform:scale(.98)}.btn:disabled{opacity:.5;cursor:not-allowed;transform:none}.status{background:rgba(0,0,0,.26);border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:12px;font-family:var(--mono);font-size:clamp(11px, 2.8vw, 12px);color:rgba(255,255,255,.7);white-space:pre-wrap;line-height:1.6;max-height:22vh;overflow:auto}.result-note{margin-bottom:12px;max-height:18vh}.modal-body{overflow:auto;min-height:0}.result-item{margin-bottom:12px}.result-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.result-label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:rgba(255,255,255,.5)}.btn-copy{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.14);border-radius:8px;padding:6px 12px;font-size:11px;font-weight:600;color:rgba(255,255,255,.88);cursor:pointer;transition:all .2s}.btn-close{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.14);border-radius:10px;width:34px;height:34px;display:inline-flex;align-items:center;justify-content:center;font-size:16px;font-weight:800;color:rgba(255,255,255,.88);cursor:pointer}.btn-copy:active{transform:scale(.95)}.result-value{background:rgba(0,0,0,.26);border:1px solid rgba(255,255,255,.12);border-radius:10px;padding:12px;font-family:var(--mono);font-size:clamp(11px, 2.8vw, 12px);color:rgba(255,255,255,.8);word-break:break-all;line-height:1.5}.result-value.result-value--addr{font-size:clamp(12px, 3vw, 13px)}.qr-wrap{margin-top:10px;display:flex;justify-content:center;align-items:center;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.18)}.qr-wrap canvas{display:block;max-width:240px;width:240px;height:240px;border-radius:10px}.scan-wrap{margin-top:10px;display:flex;justify-content:center;align-items:center;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.18)}.scan-wrap video{display:block;width:100%;max-width:360px;border-radius:12px}.info{background:rgba(255,204,102,.1);border:1px solid rgba(255,204,102,.4);border-radius:10px;padding:10px 12px;font-size:clamp(11px, 2.8vw, 12px);color:rgba(255,229,180,.95);margin-top:12px;line-height:1.4}.hidden{display:none!important}@keyframes spin{to{transform:rotate(360deg)}}.spinner{display:inline-block;width:14px;height:14px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin .8s linear infinite;margin-right:8px;vertical-align:middle}.word-picker{background:rgba(0,0,0,.18);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px;margin-top:12px}.word-selected{min-height:44px;padding:10px;border-radius:10px;border:1px dashed rgba(255,255,255,.18);background:rgba(0,0,0,.18);display:flex;flex-wrap:wrap;gap:8px;align-items:center}.word-selected.empty::before{content:'Tap words below to build a seed phrase.';color:rgba(255,255,255,.45);font-size:12px}.word-chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:rgba(75,227,255,.14);border:1px solid rgba(75,227,255,.22);color:rgba(255,255,255,.9);font-family:var(--mono);font-size:12px;cursor:pointer}.word-chip .x{opacity:.8;font-weight:700}.word-count{margin-top:10px;font-size:12px;color:rgba(255,255,255,.6);text-align:center}.word-count.complete{color:rgba(75,227,255,.95)}.word-grid{margin-top:12px;display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:8px;max-height:176px;overflow:auto;-webkit-overflow-scrolling:touch;overscroll-behavior:contain;touch-action:pan-y;padding-right:4px}@media (max-height:740px){header{padding:12px 16px}.content{padding:0 16px 16px;gap:10px}.card{padding:14px}.step{margin-bottom:14px}.preview{margin:10px 0;padding:12px}.word-grid{max-height:150px}#statusCard{left:16px;right:16px}}.word-btn{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.14);border-radius:12px;padding:10px;color:rgba(255,255,255,.85);font-family:var(--mono);font-size:12px;cursor:pointer}.word-btn:active{transform:scale(.98)}.word-actions{margin-top:12px;display:grid;grid-template-columns:1fr 1fr;gap:10px}.btn-secondary{width:100%;border-radius:12px;padding:14px;font-size:14px;font-weight:700;border:1px solid rgba(255,255,255,.14);cursor:pointer;transition:all .2s}.btn-clear{background:rgba(255,59,48,.1);color:rgba(255,255,255,.9);border:1px solid rgba(255,59,48,.25)}.btn-derive{border:1px solid rgba(75,227,255,.45);background:linear-gradient(135deg,rgba(138,92,255,.22),rgba(75,227,255,.18));color:#fff;box-shadow:0 10px 28px rgba(0,0,0,.35)}.btn-derive:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}</style><script type="module">const n="aca5e63ee6292f0de402adf6603072eceaad3872e7fa3e91b91bf40d95c75875i0";function t(n){return(n||"").trim().toLowerCase()}function r(n){const t=Array.from(new Set(n.split("").filter(n=>!"qpzry9x8gf2tvdw0s3jn54khce6mua7l".includes(n)))).sort();if(t.length)throw new Error("Invalid characters: "+t.join(""))}function e(n,t){const r=String(n||"").split(/\r?\n/).map(n=>n.trim()).filter(Boolean);if(2048!==r.length)throw new Error(`${t} must be 2048 words (got ${r.length}).`);for(const n of r)if(!/^[a-z]+$/.test(n))throw new Error(`${t} contains an invalid word: ${JSON.stringify(n)}`);return r}async function o(n){const t=await fetch(n,{cache:"force-cache",redirect:"follow",referrerPolicy:"no-referrer"});if(!t.ok)throw new Error(`HTTP ${t.status} for ${n}`);return await t.text()}let s=null;async function i(){return s||(s=(async()=>{const t=`/content/${n}`,r=`https://ordinals.com/content/${n}`;try{return e(await o(t),"BIP39 wordlist")}catch{try{return e(await o(r),"BIP39 wordlist")}catch{const n=function(){const n=document.getElementById("embeddedBip39Wordlist"),t=((null==n?void 0:n.textContent)||"").trim();return t?e(t,"Embedded BIP39 wordlist"):null}();if(n)return n;throw new Error(`Failed to load BIP39 wordlist from inscription and none embedded. Tried ${t} and ${r}.`)}}})(),s)}function a(){const n=new Blob(["// Worker module: generates Taproot addresses and optionally mnemonics.\r\n\r\nconst BECH32_CHARSET = 'qpzry9x8gf2tvdw0s3jn54khce6mua7l';\r\n\r\nconst SECP_P = BigInt('0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F');\r\nconst SECP_N = BigInt('0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141');\r\nconst Gx = BigInt('0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798');\r\nconst Gy = BigInt('0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8');\r\n\r\nconst SHA256_K = new Uint32Array([\r\n  0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\r\n  0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\r\n  0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\r\n  0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\r\n  0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\r\n  0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\r\n  0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\r\n  0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,\r\n]);\r\n\r\nfunction rotr(x, n) {\r\n  return (x >>> n) | (x << (32 - n));\r\n}\r\n\r\nfunction sha256(msg) {\r\n  const l = msg.length;\r\n  const bitLenHi = Math.floor((l * 8) / 0x100000000);\r\n  const bitLenLo = (l * 8) >>> 0;\r\n\r\n  const withOne = l + 1;\r\n  const padLen = withOne % 64 <= 56 ? 56 - (withOne % 64) : 56 + (64 - (withOne % 64));\r\n  const totalLen = withOne + padLen + 8;\r\n  const m = new Uint8Array(totalLen);\r\n  m.set(msg, 0);\r\n  m[l] = 0x80;\r\n  m[totalLen - 8] = (bitLenHi >>> 24) & 0xff;\r\n  m[totalLen - 7] = (bitLenHi >>> 16) & 0xff;\r\n  m[totalLen - 6] = (bitLenHi >>> 8) & 0xff;\r\n  m[totalLen - 5] = bitLenHi & 0xff;\r\n  m[totalLen - 4] = (bitLenLo >>> 24) & 0xff;\r\n  m[totalLen - 3] = (bitLenLo >>> 16) & 0xff;\r\n  m[totalLen - 2] = (bitLenLo >>> 8) & 0xff;\r\n  m[totalLen - 1] = bitLenLo & 0xff;\r\n\r\n  let h0 = 0x6a09e667;\r\n  let h1 = 0xbb67ae85;\r\n  let h2 = 0x3c6ef372;\r\n  let h3 = 0xa54ff53a;\r\n  let h4 = 0x510e527f;\r\n  let h5 = 0x9b05688c;\r\n  let h6 = 0x1f83d9ab;\r\n  let h7 = 0x5be0cd19;\r\n\r\n  const w = new Uint32Array(64);\r\n  for (let i = 0; i < m.length; i += 64) {\r\n    for (let t = 0; t < 16; t++) {\r\n      const j = i + t * 4;\r\n      w[t] = ((m[j] << 24) | (m[j + 1] << 16) | (m[j + 2] << 8) | m[j + 3]) >>> 0;\r\n    }\r\n    for (let t = 16; t < 64; t++) {\r\n      const s0 = (rotr(w[t - 15], 7) ^ rotr(w[t - 15], 18) ^ (w[t - 15] >>> 3)) >>> 0;\r\n      const s1 = (rotr(w[t - 2], 17) ^ rotr(w[t - 2], 19) ^ (w[t - 2] >>> 10)) >>> 0;\r\n      w[t] = (w[t - 16] + s0 + w[t - 7] + s1) >>> 0;\r\n    }\r\n\r\n    let a = h0,\r\n      b = h1,\r\n      c = h2,\r\n      d = h3,\r\n      e = h4,\r\n      f = h5,\r\n      g = h6,\r\n      h = h7;\r\n\r\n    for (let t = 0; t < 64; t++) {\r\n      const S1 = (rotr(e, 6) ^ rotr(e, 11) ^ rotr(e, 25)) >>> 0;\r\n      const ch = ((e & f) ^ (~e & g)) >>> 0;\r\n      const temp1 = (h + S1 + ch + SHA256_K[t] + w[t]) >>> 0;\r\n      const S0 = (rotr(a, 2) ^ rotr(a, 13) ^ rotr(a, 22)) >>> 0;\r\n      const maj = ((a & b) ^ (a & c) ^ (b & c)) >>> 0;\r\n      const temp2 = (S0 + maj) >>> 0;\r\n\r\n      h = g;\r\n      g = f;\r\n      f = e;\r\n      e = (d + temp1) >>> 0;\r\n      d = c;\r\n      c = b;\r\n      b = a;\r\n      a = (temp1 + temp2) >>> 0;\r\n    }\r\n\r\n    h0 = (h0 + a) >>> 0;\r\n    h1 = (h1 + b) >>> 0;\r\n    h2 = (h2 + c) >>> 0;\r\n    h3 = (h3 + d) >>> 0;\r\n    h4 = (h4 + e) >>> 0;\r\n    h5 = (h5 + f) >>> 0;\r\n    h6 = (h6 + g) >>> 0;\r\n    h7 = (h7 + h) >>> 0;\r\n  }\r\n\r\n  const out = new Uint8Array(32);\r\n  const hs = [h0, h1, h2, h3, h4, h5, h6, h7];\r\n  for (let i = 0; i < hs.length; i++) {\r\n    out[i * 4] = (hs[i] >>> 24) & 0xff;\r\n    out[i * 4 + 1] = (hs[i] >>> 16) & 0xff;\r\n    out[i * 4 + 2] = (hs[i] >>> 8) & 0xff;\r\n    out[i * 4 + 3] = hs[i] & 0xff;\r\n  }\r\n  return out;\r\n}\r\n\r\nconst TAPTWEAK_TAG = sha256(new TextEncoder().encode('TapTweak'));\r\n\r\nfunction concat3(a, b, c) {\r\n  const len = a.length + b.length + (c ? c.length : 0);\r\n  const out = new Uint8Array(len);\r\n  out.set(a, 0);\r\n  out.set(b, a.length);\r\n  if (c) out.set(c, a.length + b.length);\r\n  return out;\r\n}\r\n\r\nfunction tapTweakHash(xOnlyPubkey32) {\r\n  return sha256(concat3(TAPTWEAK_TAG, TAPTWEAK_TAG, xOnlyPubkey32));\r\n}\r\n\r\nfunction mod(a, m) {\r\n  const r = a % m;\r\n  return r >= 0n ? r : r + m;\r\n}\r\n\r\nfunction invMod(a, m) {\r\n  let lm = 1n,\r\n    hm = 0n;\r\n  let low = mod(a, m),\r\n    high = m;\r\n  while (low > 1n) {\r\n    const r = high / low;\r\n    const nm = hm - lm * r;\r\n    const nw = high - low * r;\r\n    hm = lm;\r\n    lm = nm;\r\n    high = low;\r\n    low = nw;\r\n  }\r\n  return mod(lm, m);\r\n}\r\n\r\nfunction bytesToBigInt(bytes) {\r\n  let x = 0n;\r\n  for (const b of bytes) x = (x << 8n) + BigInt(b);\r\n  return x;\r\n}\r\n\r\nfunction bigIntToBytes32(x) {\r\n  let v = x;\r\n  const out = new Uint8Array(32);\r\n  for (let i = 31; i >= 0; i--) {\r\n    out[i] = Number(v & 0xffn);\r\n    v >>= 8n;\r\n  }\r\n  return out;\r\n}\r\n\r\nfunction isOdd(x) {\r\n  return (x & 1n) === 1n;\r\n}\r\n\r\nfunction jacobianInfinity() {\r\n  return { X: 0n, Y: 1n, Z: 0n };\r\n}\r\n\r\nfunction isInfinity(P) {\r\n  return P.Z === 0n;\r\n}\r\n\r\nfunction jacobianDouble(P) {\r\n  if (isInfinity(P)) return P;\r\n  const X1 = P.X,\r\n    Y1 = P.Y,\r\n    Z1 = P.Z;\r\n  const A = mod(X1 * X1, SECP_P);\r\n  const B = mod(Y1 * Y1, SECP_P);\r\n  const C = mod(B * B, SECP_P);\r\n  const X1plusB = mod(X1 + B, SECP_P);\r\n  const D = mod(2n * (mod(X1plusB * X1plusB, SECP_P) - A - C), SECP_P);\r\n  const E = mod(3n * A, SECP_P);\r\n  const F = mod(E * E, SECP_P);\r\n  const X3 = mod(F - 2n * D, SECP_P);\r\n  const Y3 = mod(E * (D - X3) - 8n * C, SECP_P);\r\n  const Z3 = mod(2n * Y1 * Z1, SECP_P);\r\n  return { X: X3, Y: Y3, Z: Z3 };\r\n}\r\n\r\nfunction jacobianAddMixed(P, Q) {\r\n  if (isInfinity(P)) return { X: Q.x, Y: Q.y, Z: 1n };\r\n  const X1 = P.X,\r\n    Y1 = P.Y,\r\n    Z1 = P.Z;\r\n  const x2 = Q.x,\r\n    y2 = Q.y;\r\n\r\n  const Z1Z1 = mod(Z1 * Z1, SECP_P);\r\n  const U2 = mod(x2 * Z1Z1, SECP_P);\r\n  const S2 = mod(y2 * Z1 * Z1Z1, SECP_P);\r\n  const H = mod(U2 - X1, SECP_P);\r\n  const r = mod(2n * (S2 - Y1), SECP_P);\r\n\r\n  if (H === 0n) {\r\n    if (r === 0n) return jacobianDouble(P);\r\n    return jacobianInfinity();\r\n  }\r\n\r\n  const HH = mod(H * H, SECP_P);\r\n  const I = mod(4n * HH, SECP_P);\r\n  const J = mod(H * I, SECP_P);\r\n  const V = mod(X1 * I, SECP_P);\r\n  const X3 = mod(r * r - J - 2n * V, SECP_P);\r\n  const Y3 = mod(r * (V - X3) - 2n * Y1 * J, SECP_P);\r\n  const Z3 = mod((Z1 + H) * (Z1 + H) - Z1Z1 - HH, SECP_P);\r\n  return { X: X3, Y: Y3, Z: Z3 };\r\n}\r\n\r\nfunction jacobianToAffine(P) {\r\n  if (isInfinity(P)) return null;\r\n  const zInv = invMod(P.Z, SECP_P);\r\n  const zInv2 = mod(zInv * zInv, SECP_P);\r\n  const x = mod(P.X * zInv2, SECP_P);\r\n  const y = mod(P.Y * zInv2 * zInv, SECP_P);\r\n  return { x, y };\r\n}\r\n\r\nconst G_AFFINE = { x: Gx, y: Gy };\r\n\r\nfunction scalarMulG(k) {\r\n  const n = k;\r\n  let R = jacobianInfinity();\r\n  for (let i = 255; i >= 0; i--) {\r\n    R = jacobianDouble(R);\r\n    if (((n >> BigInt(i)) & 1n) === 1n) R = jacobianAddMixed(R, G_AFFINE);\r\n  }\r\n  return jacobianToAffine(R);\r\n}\r\n\r\nfunction convertBits(data, fromBits, toBits, pad) {\r\n  let acc = 0;\r\n  let bits = 0;\r\n  const ret = [];\r\n  const maxv = (1 << toBits) - 1;\r\n  for (const value of data) {\r\n    if (value < 0 || (value >> fromBits) !== 0) return null;\r\n    acc = (acc << fromBits) | value;\r\n    bits += fromBits;\r\n    while (bits >= toBits) {\r\n      bits -= toBits;\r\n      ret.push((acc >> bits) & maxv);\r\n    }\r\n  }\r\n  if (pad) {\r\n    if (bits > 0) ret.push((acc << (toBits - bits)) & maxv);\r\n  } else if (bits >= fromBits || ((acc << (toBits - bits)) & maxv)) {\r\n    return null;\r\n  }\r\n  return ret;\r\n}\r\n\r\nfunction bech32Polymod(values) {\r\n  const GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\r\n  let chk = 1;\r\n  for (const v of values) {\r\n    const top = chk >>> 25;\r\n    chk = ((chk & 0x1ffffff) << 5) ^ v;\r\n    for (let i = 0; i < 5; i++) if ((top >>> i) & 1) chk ^= GENERATORS[i];\r\n  }\r\n  return chk >>> 0;\r\n}\r\n\r\nfunction bech32HrpExpand(hrp) {\r\n  const ret = [];\r\n  for (let i = 0; i < hrp.length; i++) ret.push(hrp.charCodeAt(i) >>> 5);\r\n  ret.push(0);\r\n  for (let i = 0; i < hrp.length; i++) ret.push(hrp.charCodeAt(i) & 31);\r\n  return ret;\r\n}\r\n\r\nfunction bech32CreateChecksum(hrp, data, specConstant) {\r\n  const values = bech32HrpExpand(hrp).concat(data).concat([0, 0, 0, 0, 0, 0]);\r\n  const polymod = bech32Polymod(values) ^ specConstant;\r\n  const ret = [];\r\n  for (let p = 0; p < 6; p++) ret.push((polymod >>> (5 * (5 - p))) & 31);\r\n  return ret;\r\n}\r\n\r\nfunction bech32Encode(hrp, data, specConstant) {\r\n  const combined = data.concat(bech32CreateChecksum(hrp, data, specConstant));\r\n  let ret = hrp + '1';\r\n  for (const d of combined) ret += BECH32_CHARSET[d];\r\n  return ret;\r\n}\r\n\r\nfunction encodeSegwitAddressV1(hrp, program) {\r\n  const BECH32M = 0x2bc830a3;\r\n  const data = [1].concat(convertBits(program, 8, 5, true));\r\n  return bech32Encode(hrp, data, BECH32M);\r\n}\r\n\r\nfunction getTaprootAddressFromPrivkey(privBytes, hrp = 'bc') {\r\n  let k = bytesToBigInt(privBytes);\r\n  if (k === 0n || k >= SECP_N) return null;\r\n\r\n  let P = scalarMulG(k);\r\n  if (!P) return null;\r\n\r\n  if (isOdd(P.y)) {\r\n    k = mod(SECP_N - k, SECP_N);\r\n    P = { x: P.x, y: mod(SECP_P - P.y, SECP_P) };\r\n  }\r\n\r\n  const xOnly = bigIntToBytes32(P.x);\r\n  const tweakBytes = tapTweakHash(xOnly);\r\n  const tweak = mod(bytesToBigInt(tweakBytes), SECP_N);\r\n  const k2 = mod(k + tweak, SECP_N);\r\n  if (k2 === 0n) return null;\r\n\r\n  const Q = scalarMulG(k2);\r\n  if (!Q) return null;\r\n  const outX = bigIntToBytes32(Q.x);\r\n  return encodeSegwitAddressV1(hrp, outX);\r\n}\r\n\r\nfunction bytesToHex(bytes) {\r\n  return Array.from(bytes)\r\n    .map((b) => b.toString(16).padStart(2, '0'))\r\n    .join('');\r\n}\r\n\r\nfunction u32be(n) {\r\n  const out = new Uint8Array(4);\r\n  out[0] = (n >>> 24) & 0xff;\r\n  out[1] = (n >>> 16) & 0xff;\r\n  out[2] = (n >>> 8) & 0xff;\r\n  out[3] = n & 0xff;\r\n  return out;\r\n}\r\n\r\nfunction concatBytes(...arrs) {\r\n  const len = arrs.reduce((n, a) => n + (a?.length || 0), 0);\r\n  const out = new Uint8Array(len);\r\n  let off = 0;\r\n  for (const a of arrs) {\r\n    out.set(a, off);\r\n    off += a.length;\r\n  }\r\n  return out;\r\n}\r\n\r\nasync function hmacSha512(keyBytes, dataBytes) {\r\n  const key = await crypto.subtle.importKey('raw', keyBytes, { name: 'HMAC', hash: 'SHA-512' }, false, ['sign']);\r\n  const sig = await crypto.subtle.sign('HMAC', key, dataBytes);\r\n  return new Uint8Array(sig);\r\n}\r\n\r\nasync function pbkdf2Sha512(passwordBytes, saltBytes, iterations, outLenBytes) {\r\n  const key = await crypto.subtle.importKey('raw', passwordBytes, 'PBKDF2', false, ['deriveBits']);\r\n  const bits = await crypto.subtle.deriveBits(\r\n    { name: 'PBKDF2', salt: saltBytes, iterations, hash: 'SHA-512' },\r\n    key,\r\n    outLenBytes * 8,\r\n  );\r\n  return new Uint8Array(bits);\r\n}\r\n\r\nfunction utf8Bytes(s) {\r\n  return new TextEncoder().encode(s);\r\n}\r\n\r\nfunction modN(x) {\r\n  const r = x % SECP_N;\r\n  return r >= 0n ? r : r + SECP_N;\r\n}\r\n\r\nfunction getCompressedPubkeyFromPrivkey(privBytes) {\r\n  let k = bytesToBigInt(privBytes);\r\n  if (k === 0n || k >= SECP_N) return null;\r\n  const P = scalarMulG(k);\r\n  if (!P) return null;\r\n  const prefix = isOdd(P.y) ? 0x03 : 0x02;\r\n  const xBytes = bigIntToBytes32(P.x);\r\n  const out = new Uint8Array(33);\r\n  out[0] = prefix;\r\n  out.set(xBytes, 1);\r\n  return out;\r\n}\r\n\r\nasync function bip32MasterFromSeed(seedBytes) {\r\n  const I = await hmacSha512(utf8Bytes('Bitcoin seed'), seedBytes);\r\n  const IL = I.slice(0, 32);\r\n  const IR = I.slice(32);\r\n  const k = bytesToBigInt(IL);\r\n  if (k === 0n || k >= SECP_N) throw new Error('Invalid BIP32 master key');\r\n  return { k, c: IR };\r\n}\r\n\r\nasync function bip32CkdPriv(node, index, hardened) {\r\n  const base = Number(index);\r\n  if (!Number.isInteger(base) || base < 0 || base > 0x7fffffff) throw new Error('Invalid index');\r\n  const idx = hardened ? ((base + 0x80000000) >>> 0) : base >>> 0;\r\n\r\n  let data;\r\n  if (hardened) {\r\n    data = concatBytes(new Uint8Array([0]), bigIntToBytes32(node.k), u32be(idx));\r\n  } else {\r\n    const pub = getCompressedPubkeyFromPrivkey(bigIntToBytes32(node.k));\r\n    if (!pub) throw new Error('Pubkey derivation failed');\r\n    data = concatBytes(pub, u32be(idx));\r\n  }\r\n\r\n  const I = await hmacSha512(node.c, data);\r\n  const IL = I.slice(0, 32);\r\n  const IR = I.slice(32);\r\n  const ILi = bytesToBigInt(IL);\r\n  if (ILi >= SECP_N) throw new Error('Invalid BIP32 child (IL >= n)');\r\n  const childK = modN(ILi + node.k);\r\n  if (childK === 0n) throw new Error('Invalid BIP32 child (k == 0)');\r\n  return { k: childK, c: IR };\r\n}\r\n\r\nasync function deriveBip86FirstPrivkeyFromMnemonic(mnemonic) {\r\n  const normalized = (mnemonic || '').trim().toLowerCase().replace(/\\s+/g, ' ');\r\n  if (!normalized) throw new Error('Missing mnemonic');\r\n  const seed = await pbkdf2Sha512(utf8Bytes(normalized), utf8Bytes('mnemonic'), 2048, 64);\r\n  let node = await bip32MasterFromSeed(seed);\r\n  node = await bip32CkdPriv(node, 86, true);\r\n  node = await bip32CkdPriv(node, 0, true);\r\n  node = await bip32CkdPriv(node, 0, true);\r\n  node = await bip32CkdPriv(node, 0, false);\r\n  node = await bip32CkdPriv(node, 0, false);\r\n  return bigIntToBytes32(node.k);\r\n}\r\n\r\nfunction getBit(bytes, bitIndex) {\r\n  const byteIndex = Math.floor(bitIndex / 8);\r\n  const offset = 7 - (bitIndex % 8);\r\n  return (bytes[byteIndex] >> offset) & 1;\r\n}\r\n\r\nfunction bitsToInt(bits, start, length) {\r\n  let v = 0;\r\n  for (let i = 0; i < length; i++) v = (v << 1) | bits[start + i];\r\n  return v;\r\n}\r\n\r\nfunction validateBip39MnemonicChecksum(mnemonic, wordlist) {\r\n  if (!Array.isArray(wordlist) || wordlist.length !== 2048) {\r\n    throw new Error('Missing BIP39 wordlist');\r\n  }\r\n\r\n  const words = String(mnemonic || '')\r\n    .trim()\r\n    .toLowerCase()\r\n    .split(/\\s+/)\r\n    .filter(Boolean);\r\n\r\n  const wc = words.length;\r\n  if (wc !== 12 && wc !== 24) {\r\n    throw new Error('Mnemonic must be 12 or 24 words to validate');\r\n  }\r\n\r\n  const wordToIndex = new Map();\r\n  for (let i = 0; i < wordlist.length; i++) wordToIndex.set(wordlist[i], i);\r\n\r\n  const totalBits = wc * 11;\r\n  const bits = new Array(totalBits);\r\n  let bitPos = 0;\r\n\r\n  for (const w of words) {\r\n    const idx = wordToIndex.get(w);\r\n    if (typeof idx !== 'number') throw new Error(`Invalid BIP39 word: ${JSON.stringify(w)}`);\r\n    for (let b = 10; b >= 0; b--) bits[bitPos++] = (idx >> b) & 1;\r\n  }\r\n\r\n  const entBits = wc === 12 ? 128 : 256;\r\n  const checksumBits = entBits / 32;\r\n\r\n  const entBytes = entBits / 8;\r\n  const entropy = new Uint8Array(entBytes);\r\n  for (let i = 0; i < entBytes; i++) {\r\n    let v = 0;\r\n    for (let b = 0; b < 8; b++) v = (v << 1) | bits[i * 8 + b];\r\n    entropy[i] = v;\r\n  }\r\n\r\n  const hash = sha256(entropy);\r\n  for (let i = 0; i < checksumBits; i++) {\r\n    const want = getBit(hash, i);\r\n    const have = bits[entBits + i];\r\n    if (want !== have) throw new Error('BIP39 checksum mismatch');\r\n  }\r\n}\r\n\r\nfunction computeBip39LastWordCandidates(prefixWords, wordCount, wordlist) {\r\n  if (!Array.isArray(prefixWords)) throw new Error('Missing prefixWords');\r\n  if (!Array.isArray(wordlist) || wordlist.length !== 2048) throw new Error('Missing BIP39 wordlist');\r\n  if (wordCount !== 12 && wordCount !== 24) throw new Error('Word count must be 12 or 24');\r\n  if (prefixWords.length !== wordCount - 1) throw new Error(`Need exactly ${wordCount - 1} words to compute last-word candidates`);\r\n\r\n  const wordToIndex = new Map();\r\n  for (let i = 0; i < wordlist.length; i++) wordToIndex.set(wordlist[i], i);\r\n\r\n  const prefixBits = [];\r\n  for (const w of prefixWords) {\r\n    const idx = wordToIndex.get(String(w || '').trim().toLowerCase());\r\n    if (typeof idx !== 'number') throw new Error(`Invalid BIP39 word: ${JSON.stringify(w)}`);\r\n    for (let b = 10; b >= 0; b--) prefixBits.push((idx >> b) & 1);\r\n  }\r\n\r\n  const entBits = wordCount === 12 ? 128 : 256;\r\n  const checksumBits = entBits / 32;\r\n  const remainingEntBits = entBits - prefixBits.length;\r\n\r\n  if (remainingEntBits <= 0 || remainingEntBits >= 11) {\r\n    throw new Error('Unexpected prefix length for BIP39');\r\n  }\r\n\r\n  const candidates = new Set();\r\n\r\n  const max = 1 << remainingEntBits;\r\n  for (let suffixEnt = 0; suffixEnt < max; suffixEnt++) {\r\n    const entropyBits = prefixBits.slice();\r\n    for (let b = remainingEntBits - 1; b >= 0; b--) entropyBits.push((suffixEnt >> b) & 1);\r\n\r\n    const entBytes = entBits / 8;\r\n    const entropy = new Uint8Array(entBytes);\r\n    for (let i = 0; i < entBytes; i++) {\r\n      let v = 0;\r\n      for (let b = 0; b < 8; b++) v = (v << 1) | entropyBits[i * 8 + b];\r\n      entropy[i] = v;\r\n    }\r\n\r\n    const hash = sha256(entropy);\r\n    let checksumVal = 0;\r\n    for (let i = 0; i < checksumBits; i++) checksumVal = (checksumVal << 1) | getBit(hash, i);\r\n\r\n    const lastIndex = (suffixEnt << checksumBits) | checksumVal;\r\n    candidates.add(wordlist[lastIndex]);\r\n  }\r\n\r\n  return Array.from(candidates);\r\n}\r\n\r\nfunction generateMnemonic(wordCount, wordlist) {\r\n  const entBits = wordCount === 12 ? 128 : 256;\r\n  const entBytes = entBits / 8;\r\n  const checksumBits = entBits / 32;\r\n\r\n  const entropy = new Uint8Array(entBytes);\r\n  crypto.getRandomValues(entropy);\r\n  const hash = sha256(entropy);\r\n\r\n  const totalBits = entBits + checksumBits;\r\n  const bits = new Array(totalBits);\r\n  for (let i = 0; i < entBits; i++) bits[i] = getBit(entropy, i);\r\n  for (let i = 0; i < checksumBits; i++) bits[entBits + i] = getBit(hash, i);\r\n\r\n  const words = [];\r\n  for (let i = 0; i < totalBits; i += 11) {\r\n    const idx = bitsToInt(bits, i, 11);\r\n    words.push(wordlist[idx]);\r\n  }\r\n  return words.join(' ');\r\n}\r\n\r\nfunction validatePattern(pattern) {\r\n  const bad = Array.from(new Set(pattern.split('').filter((c) => !BECH32_CHARSET.includes(c)))).sort();\r\n  if (bad.length) throw new Error('Invalid chars: ' + bad.join(''));\r\n}\r\n\r\nlet running = false;\r\n\r\nself.onmessage = async (ev) => {\r\n  const { type, runId, prefix, suffix, outputKind, wordCount, wordlist, mnemonic, prefixWords } = ev.data || {};\r\n\r\n  try {\r\n    if (type === 'checksumCandidates') {\r\n      const candidates = computeBip39LastWordCandidates(prefixWords, wordCount, wordlist);\r\n      self.postMessage({ type: 'checksumCandidates', candidates });\r\n      return;\r\n    }\r\n\r\n    if (type === 'derive') {\r\n      if (!mnemonic) {\r\n        self.postMessage({ type: 'error', error: 'Missing mnemonic' });\r\n        return;\r\n      }\r\n\r\n      // Safety: when deriving from a user-picked mnemonic, validate that the\r\n      // phrase is a real BIP39 mnemonic (checksum) if we were given a wordlist.\r\n      // This prevents users from generating a phrase that common wallets reject.\r\n      if (Array.isArray(wordlist) && wordlist.length === 2048) {\r\n        validateBip39MnemonicChecksum(mnemonic, wordlist);\r\n      }\r\n\r\n      const priv = await deriveBip86FirstPrivkeyFromMnemonic(mnemonic);\r\n      const address = getTaprootAddressFromPrivkey(priv, 'bc');\r\n      if (!address) {\r\n        self.postMessage({ type: 'error', error: 'Failed to derive address' });\r\n        return;\r\n      }\r\n      self.postMessage({ type: 'derived', address });\r\n      return;\r\n    }\r\n\r\n    running = true;\r\n\r\n    if (prefix) validatePattern(prefix);\r\n    if (suffix) validatePattern(suffix);\r\n\r\n    const wantPrefix = prefix ? 'bc1p' + prefix : null;\r\n    const wantSuffix = suffix || null;\r\n\r\n    let attempts = 0;\r\n    let lastProgress = performance.now();\r\n\r\n    while (running) {\r\n      let address = null;\r\n      let secret = null;\r\n      let secretLabel = null;\r\n\r\n      if (outputKind === 'mnemonic') {\r\n        const wc = wordCount === 24 ? 24 : 12;\r\n        if (!Array.isArray(wordlist) || wordlist.length !== 2048) throw new Error('Missing BIP39 wordlist');\r\n        const mnem = generateMnemonic(wc, wordlist);\r\n        const priv = await deriveBip86FirstPrivkeyFromMnemonic(mnem);\r\n        address = getTaprootAddressFromPrivkey(priv, 'bc');\r\n        if (!address) continue;\r\n        secret = mnem;\r\n        secretLabel = wc === 24 ? 'Seed phrase (24 words)' : 'Seed phrase (12 words)';\r\n      } else {\r\n        const priv = new Uint8Array(32);\r\n        crypto.getRandomValues(priv);\r\n        address = getTaprootAddressFromPrivkey(priv, 'bc');\r\n        if (!address) continue;\r\n        secret = bytesToHex(priv);\r\n        secretLabel = 'Private key (hex)';\r\n      }\r\n\r\n      const okPrefix = wantPrefix ? address.startsWith(wantPrefix) : true;\r\n      const okSuffix = wantSuffix ? address.endsWith(wantSuffix) : true;\r\n      attempts++;\r\n\r\n      if (okPrefix && okSuffix) {\r\n        self.postMessage({ type: 'found', runId, address, secret, secretLabel, attempts });\r\n        return;\r\n      }\r\n\r\n      const now = performance.now();\r\n      if (now - lastProgress > 250) {\r\n        self.postMessage({ type: 'progress', runId, attempts });\r\n        attempts = 0;\r\n        lastProgress = now;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    self.postMessage({ type: 'error', runId, error: String(e?.message || e) });\r\n  }\r\n};\r\n"],{type:"text/javascript"}),t=URL.createObjectURL(n),r=new Worker(t,{type:"module"});return URL.revokeObjectURL(t),r}const c=n=>document.getElementById(n);let d=null,l=null,u="status",f=null,h="Secret",p=!1,m=!1,w="",y=!1,x=null,b=!1;function g(n){const t=String.fromCharCode(...n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function v(n){const t=String(n||"").replace(/-/g,"+").replace(/_/g,"/"),r=t.length%4==0?"":"=".repeat(4-t.length%4),e=atob(t+r),o=new Uint8Array(e.length);for(let n=0;n<e.length;n++)o[n]=e.charCodeAt(n);return o}function C(){y=!1;const n=c("secretQrPanel"),t=c("secretQrWrap"),r=c("secretQr"),e=c("secretQrPass"),o=c("secretQrCiphertext"),s=c("secretQrPlain"),i=c("toggleSecretQr"),a=c("secretQrScanWrap"),d=c("secretQrVideo"),l=c("btnSecretQrScan");n&&n.classList.add("hidden"),t&&t.classList.add("hidden"),r&&r.replaceChildren(),e&&(e.value=""),o&&(o.value=""),s&&(s.textContent="",s.classList.add("hidden")),B(),a&&a.classList.add("hidden"),d&&(d.srcObject=null),l&&(l.textContent="Scan"),i&&(i.textContent="QR")}function S(){const n=function(){const n=String(window.location.pathname||"").split("/").filter(Boolean),t=n[n.length-1]||"";return n.length>=2&&"content"===n[n.length-2]&&t||t&&t.includes("i0")?t:""}();return n?`https://ordinals.com/content/${n}`:window.location.href.split("#")[0]}function E(n){const t=S(),r=g(function(n){return(new TextEncoder).encode(String(n??""))}(String(n||"").trim()));return`${t}#venc=${r}`}function B(){if(b=!1,x){try{for(const n of x.getTracks())n.stop()}catch{}x=null}}async function P(){var n;const t=c("secretQrScanWrap"),r=c("secretQrVideo"),e=c("btnSecretQrScan"),o=c("secretQrCiphertext");if(!t||!r||!o||b)return;if(null==(n=navigator.mediaDevices)||!n.getUserMedia)throw new Error("Camera not supported in this browser.");if(!("BarcodeDetector"in window))throw new Error("QR scanning not supported in this browser.");x=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1}),r.srcObject=x,r.setAttribute("playsinline","true"),await r.play(),b=!0,t.classList.remove("hidden"),e&&(e.textContent="Stop");const s=new window.BarcodeDetector({formats:["qr_code"]}),i=async()=>{var n;if(b){try{const i=await s.detect(r),a=null==(n=null==i?void 0:i[0])?void 0:n.rawValue;if("string"==typeof a&&a.trim()){const n=function(n){const t=String(n||"").trim();if(!t)return"";if(t.startsWith("VANITY_ENC_V1"))return t;try{const n=new URL(t),r=String(n.hash||""),e=String(n.search||""),o=new URLSearchParams(r.startsWith("#")?r.slice(1):r).get("venc"),s=new URLSearchParams(e.startsWith("?")?e.slice(1):e).get("venc"),i=o||s||"";return i?(new TextDecoder).decode(v(i)):""}catch{return""}}(a);return o.value=(n||a).trim(),B(),t.classList.add("hidden"),void(e&&(e.textContent="Scan"))}}catch{}window.requestAnimationFrame(i)}};window.requestAnimationFrame(i)}async function k(){const n=String(f||"");if(!n)return;const t=c("secretQrPass"),r=String((null==t?void 0:t.value)||""),e=c("secretQr"),o=c("secretQrWrap");if(e&&o)try{M("");const t=await async function({password:n,secret:t}){var r;if(null==(r=globalThis.crypto)||!r.subtle)throw new Error("WebCrypto is not available in this environment.");const e=String(n||"");if(!e)throw new Error("Password required.");const o=crypto.getRandomValues(new Uint8Array(16)),s=crypto.getRandomValues(new Uint8Array(12)),i=2e5,a=await crypto.subtle.importKey("raw",(new TextEncoder).encode(e),"PBKDF2",!1,["deriveKey"]),c=await crypto.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:o,iterations:i},a,{name:"AES-GCM",length:256},!1,["encrypt"]),d=(new TextEncoder).encode(String(t||"")),l=await crypto.subtle.encrypt({name:"AES-GCM",iv:s},c,d),u=new Uint8Array(l),f={v:1,kdf:"PBKDF2-SHA256",iter:i,cipher:"AES-256-GCM",salt:g(o),iv:g(s),ct:g(u)};return`VANITY_ENC_V1\n${JSON.stringify(f)}`}({password:r,secret:n}),s=E(t),i=globalThis.QrCreator;if(!i||"function"!=typeof i.render)throw new Error("QR library not available in this environment.");e.replaceChildren();const a=document.createElement("canvas");i.render({text:s,size:240,ecLevel:"M",radius:0,quiet:2,fill:"#000",background:"#fff"},a),e.appendChild(a),o.classList.remove("hidden"),M("‚úì Encrypted QR generated"),N()}catch(n){M("‚ùå "+String((null==n?void 0:n.message)||n))}}async function F(){var n,t;const r=String((null==(n=c("secretQrPass"))?void 0:n.value)||""),e=String((null==(t=c("secretQrCiphertext"))?void 0:t.value)||""),o=c("secretQrPlain");if(o)try{M("");const n=await async function({password:n,text:t}){var r;if(null==(r=globalThis.crypto)||!r.subtle)throw new Error("WebCrypto is not available in this environment.");const e=String(n||"");if(!e)throw new Error("Password required.");const o=String(t||"").trim();if(!o)throw new Error("Paste the scanned text first.");const s=o.indexOf("\n");if("VANITY_ENC_V1"!==(s>=0?o.slice(0,s):o).trim())throw new Error("Not a VANITY_ENC_V1 payload.");const i=(s>=0?o.slice(s+1):"").trim();if(!i)throw new Error("Missing payload JSON.");let a;try{a=JSON.parse(i)}catch{throw new Error("Invalid payload JSON.")}if(!a||1!==a.v)throw new Error("Unsupported payload version.");if("PBKDF2-SHA256"!==a.kdf)throw new Error("Unsupported KDF.");if("AES-256-GCM"!==a.cipher)throw new Error("Unsupported cipher.");const c=Number(a.iter);if(!Number.isFinite(c)||c<1)throw new Error("Invalid iteration count.");const d=v(a.salt),l=v(a.iv),u=v(a.ct),f=await crypto.subtle.importKey("raw",(new TextEncoder).encode(e),"PBKDF2",!1,["deriveKey"]),h=await crypto.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:d,iterations:c},f,{name:"AES-GCM",length:256},!1,["decrypt"]);let p;try{p=await crypto.subtle.decrypt({name:"AES-GCM",iv:l},h,u)}catch{throw new Error("Decrypt failed (wrong password or corrupted data).")}return(new TextDecoder).decode(new Uint8Array(p))}({password:r,text:e});o.textContent=n,o.classList.remove("hidden"),M("‚úì Decrypted locally"),N()}catch(n){o.textContent="",o.classList.add("hidden"),M("‚ùå "+String((null==n?void 0:n.message)||n))}}function L(){m=!1,w="";const n=c("addrQrWrap"),t=c("addrQr"),r=c("toggleAddrQr");n&&n.classList.add("hidden"),t&&t.replaceChildren(),r&&(r.textContent="QR")}function A(n){var t;const r=!!n,e=c("addrQrWrap"),o=c("toggleAddrQr");if(e&&e.classList.toggle("hidden",!r),o&&(o.textContent=r?"Hide QR":"QR"),m=r,!r)return;const s=String((null==(t=c("addr"))?void 0:t.textContent)||"").trim();s?s!==w&&(w=s,function(n){const t=c("addrQr");if(!t)return;t.replaceChildren();const r=globalThis.QrCreator;if(!r||"function"!=typeof r.render)return M("‚ö†Ô∏è QR library not available in this environment."),void L();const e=document.createElement("canvas");r.render({text:n,size:240,ecLevel:"M",radius:0,quiet:2,fill:"#000",background:"#fff"},e),t.appendChild(e)}(s)):L()}function I(n){p=!!n;const t=c("toggleSecret"),r=c("copySec");t&&(t.textContent=p?"Hide":"Reveal"),r&&(r.disabled=!p),c("secret").textContent=p?f||"":f?"Hidden ‚Äî tap Reveal":""}function T(){if(l)try{l.terminate()}finally{l=null}an(),f=null,h="Secret",p=!1,c("addr").textContent="",L(),C(),c("secLabel").textContent="Secret",c("copySec")&&(c("copySec").disabled=!0),c("toggleSecret")&&(c("toggleSecret").textContent="Reveal"),c("secret").textContent="",c("status").textContent="",M(""),c("statusCard").classList.add("hidden"),c("statusBackdrop").classList.add("hidden"),_("status"),Z=[],z=null,J=0,en(),on()}function Q(){const n=!(!d&&!l),t=c("btnCancel");t&&(t.disabled=!n);const r=c("statusActions");r&&r.classList.toggle("hidden",!n)}function _(n){u=n,c("statusView").classList.toggle("hidden","status"!==n),c("resultView").classList.toggle("hidden","result"!==n)}function M(n){const t=c("resultNote");if(!t)return;const r=String(n||"").trim();t.textContent=r,t.classList.toggle("hidden",!r)}function N(){window.clearTimeout(N._t),N._t=window.setTimeout(()=>M(""),1800)}function W({title:n,spinner:t}){c("statusTitle").textContent=n,c("statusSpinner").classList.toggle("hidden",!t)}function D(n,{mode:t}={}){c("statusCard").classList.remove("hidden"),c("statusBackdrop").classList.remove("hidden"),t&&_(t),c("status").textContent=n,"status"===u&&(d||l?W({title:"Working‚Ä¶",spinner:!0}):String(n||"").startsWith("‚ùå")?W({title:"Error",spinner:!1}):String(n||"").startsWith("‚úì")?W({title:"Done",spinner:!1}):W({title:"Status",spinner:!1})),Q()}function H(){window.clearTimeout(H._t),H._t=window.setTimeout(()=>{d||l||"status"===u&&(c("statusCard").classList.add("hidden"),c("statusBackdrop").classList.add("hidden"))},1800)}function R(){c("addr").textContent="",L(),C(),c("secret").textContent="",M(""),f=null,h="Secret",I(!1)}function $(){_("status"),R()}function G({address:n,secret:t,secretLabel:r}){c("addr").textContent=n,L(),C(),f=t,h=r,c("secLabel").textContent=r,I(!1),M(""),W({title:"‚úì Success!",spinner:!1}),_("result"),c("statusCard").classList.remove("hidden"),c("statusBackdrop").classList.remove("hidden"),Q()}async function U(n,t){var r;if(t)try{if(null!=(r=navigator.clipboard)&&r.writeText)return await navigator.clipboard.writeText(t),void("result"===u?(M(`‚úì ${n} copied`),N()):(D(`‚úì ${n} copied`,{mode:"status"}),H()));const e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="fixed",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),"result"===u?(M(`‚úì ${n} copied`),N()):(D(`‚úì ${n} copied`,{mode:"status"}),H())}catch(n){D(String((null==n?void 0:n.message)||n),{mode:"status"})}}function j(n){if(!Number.isFinite(n))return String(n);if(n<1e3)return Math.round(n).toLocaleString();const t=["K","M","B","T"];let r=n,e=-1;for(;r>=1e3&&e<t.length-1;)r/=1e3,e++;return r.toFixed(r>=10?1:2)+t[e]}function K(n){return n<=20?Math.pow(32,n):null}function V(){const n=t(c("prefix").value),r=t(c("suffix").value);c("prevPre").textContent=n,c("prevSuf").textContent=r;const e=n.length+r.length;if(e<=0)return void c("difficulty").classList.add("hidden");c("difficulty").classList.remove("hidden");let o="",s="";e<=2?(o="Very Easy ¬∑ few seconds",s="‚ö°"):e<=4?(o="Easy ¬∑ minutes",s="üïê"):e<=6?(o="Moderate ¬∑ could take hours",s="‚è∞"):e<=8?(o="Hard ¬∑ could take days",s="‚ö†Ô∏è"):(o="Very Hard ¬∑ could take weeks",s="üî¥");const i=K(e);i&&i<1e9&&(o+=` (~${j(i)} tries)`),c("diffIcon").textContent=s,c("diffText").textContent=o}let O=[],Z=[],X=12,Y="loading",z=null,J=0,q="idle",nn=[],tn="";async function rn(){if("ready"!==Y||!Array.isArray(O)||2048!==O.length||Z.length!==X-1||12!==X&&24!==X)return;const n=`${X}:${Z.join(" ")}`;if("ready"===q&&tn===n||"loading"===q&&tn===n)return;tn=n,q="loading",nn=[],sn(c("wordSearch").value);const t=a();let r;try{r=await new Promise((n,r)=>{const e=window.setTimeout(()=>r(new Error("Timeout computing checksum candidates")),8e3);t.onmessage=t=>{const o=t.data;"checksumCandidates"===(null==o?void 0:o.type)?(window.clearTimeout(e),n(o.candidates||[])):"error"===(null==o?void 0:o.type)&&(window.clearTimeout(e),r(new Error(o.error||"Worker error")))},t.onerror=()=>{window.clearTimeout(e),r(new Error("Worker error"))},t.postMessage({type:"checksumCandidates",prefixWords:Z,wordCount:X,wordlist:O})})}catch{tn===n&&(q="error",nn=[],sn(c("wordSearch").value));try{t.terminate()}catch{}return}try{t.terminate()}catch{}tn===n&&(q="ready",nn=Array.from(new Set(r||[])).sort(),sn(c("wordSearch").value))}function en(){const n=c("selectedWords");n.replaceChildren(),0!==Z.length?(n.className="word-selected",Z.forEach((t,r)=>{const e=document.createElement("div");e.className="word-chip";const o=document.createElement("span");o.textContent=`${r+1}. ${t}`;const s=document.createElement("span");s.className="x",s.textContent="√ó",e.appendChild(o),e.appendChild(s),e.onclick=()=>{Z.splice(r,1),z=null,J=0,q="idle",nn=[],tn="",en(),on(),sn(c("wordSearch").value),rn()},n.appendChild(e)})):n.className="word-selected empty"}function on(){const n=c("wordCount");n.textContent=`${Z.length} / ${X} words selected`,n.className=Z.length===X?"word-count complete":"word-count",c("btnDeriveAddress").disabled=Z.length!==X}function sn(n){const t=c("wordGrid");if(t.replaceChildren(),"loading"===Y){const n=document.createElement("div");return n.style.color="rgba(255,255,255,0.55)",n.style.fontSize="12px",n.style.padding="6px",n.textContent="Loading wordlist from inscription‚Ä¶",void t.appendChild(n)}if("error"===Y){const n=document.createElement("div");return n.style.color="rgba(255,255,255,0.55)",n.style.fontSize="12px",n.style.padding="6px",n.textContent="Wordlist failed to load.",void t.appendChild(n)}if(!O.length)return;if(Z.length===X-1){if("loading"===q){const n=document.createElement("div");return n.style.color="rgba(255,255,255,0.55)",n.style.fontSize="12px",n.style.padding="6px",n.textContent="Computing valid last words (checksum)‚Ä¶",void t.appendChild(n)}if("error"===q){const n=document.createElement("div");return n.style.color="rgba(255,255,255,0.55)",n.style.fontSize="12px",n.style.padding="6px",n.textContent="Could not compute checksum-valid last words.",void t.appendChild(n)}}const r=function(n){if(Z.length===X-1){if("ready"===q&&nn.length){const t=(n||"").trim().toLowerCase();return t?nn.filter(n=>n.includes(t)):nn}return null}const t=(n||"").trim().toLowerCase();return t?O.filter(n=>n.includes(t)):O}(n);if(!r)return;const e=document.createDocumentFragment();r.forEach(n=>{const t=document.createElement("button");t.type="button",t.className="word-btn",t.textContent=n,t.onclick=()=>{if(Z.length>=X)D(`‚ö†Ô∏è You already have ${X} words selected.`,{mode:"status"});else{if(Z.includes(n)){const t=performance.now();if(!(z===n&&t-J<1200))return z=n,J=t,void D("‚ö†Ô∏è Duplicate word. Tap again to add anyway.",{mode:"status"});z=null,J=0}else z=null,J=0;Z.push(n),en(),on(),sn(c("wordSearch").value),rn()}},e.appendChild(t)}),t.appendChild(e)}function an(){if(d){for(const n of d.workers)n.terminate();d=null,Q()}}function cn(){if(l)try{l.terminate()}finally{l=null}an(),c("statusCard").classList.add("hidden"),c("statusBackdrop").classList.add("hidden"),c("btnGenerate").disabled=!1,c("btnGenerate").textContent="Start Generation",W({title:"Status",spinner:!1}),R(),_("status"),on()}function dn(){var n,t;const r=String(c("outputKind").value||"priv"),e="mnemonic"===r||"pickWords"===r;c("seedLenWrap").classList.toggle("hidden",!e),c("wordPickerWrap").classList.toggle("hidden","pickWords"!==r),c("btnGenerate").classList.toggle("hidden","pickWords"===r);const o="pickWords"===r,s=c("patternCharsetStep");s&&s.classList.toggle("hidden",o);const i=null==(n=c("prefix"))?void 0:n.closest(".input-wrap"),a=null==(t=c("suffix"))?void 0:t.closest(".input-wrap");i&&i.classList.toggle("hidden",o),a&&a.classList.toggle("hidden",o),c("prefix").disabled=o,c("suffix").disabled=o,o?(c("difficulty").classList.add("hidden"),c("prevPre").textContent="",c("prevSuf").textContent=""):V(),"pickWords"===r&&(X=Number(c("seedLen").value||12),on())}var ln,un,fn,hn,pn;c("prefix").addEventListener("input",V),c("suffix").addEventListener("input",V),c("outputKind").addEventListener("change",()=>{dn()}),c("seedLen").addEventListener("change",()=>{"pickWords"===String(c("outputKind").value)&&(X=Number(c("seedLen").value||12),on())}),c("wordSearch").addEventListener("input",n=>{sn(n.target.value)}),c("btnClearWords").addEventListener("click",()=>{Z=[],z=null,J=0,q="idle",nn=[],tn="",en(),on(),sn(c("wordSearch").value)}),c("btnDeriveAddress").addEventListener("click",async function(){if(Z.length!==X)return D(`‚ö†Ô∏è Need exactly ${X} words.`,{mode:"status"}),void H();if(1===new Set(Z).size)return D("‚ö†Ô∏è Please use at least 2 different words.",{mode:"status"}),void H();try{if($(),c("btnDeriveAddress").disabled=!0,D("Deriving address‚Ä¶",{mode:"status"}),!Array.isArray(O)||2048!==O.length)throw new Error("BIP39 wordlist is not loaded yet.");const n=Z.join(" "),t=a();l=t,Q(),t.onmessage=r=>{const e=r.data;if("derived"===(null==e?void 0:e.type))G({address:e.address,secret:n,secretLabel:`Seed phrase (${X} words)`}),M("‚úì Derived"),N(),c("btnDeriveAddress").disabled=!1,l=null,Q(),t.terminate();else if("error"===(null==e?void 0:e.type)){const n=String(e.error||"Unknown error");n.includes("BIP39 checksum mismatch")?(Z=Z.slice(0,X-1),q="idle",nn=[],tn="",en(),on(),D("‚ö†Ô∏è Checksum mismatch ‚Äî pick a valid last word.",{mode:"status"}),sn(c("wordSearch").value),rn()):D("‚ùå Error: "+n,{mode:"status"}),c("btnDeriveAddress").disabled=!1,l=null,Q(),t.terminate()}},t.onerror=()=>{D("‚ùå Error: worker failed",{mode:"status"}),c("btnDeriveAddress").disabled=!1,l=null,Q(),t.terminate()},t.postMessage({type:"derive",mnemonic:n,wordlist:O})}catch(n){D("‚ùå "+String((null==n?void 0:n.message)||n),{mode:"status"}),c("btnDeriveAddress").disabled=!1}}),c("closeStatus").addEventListener("click",()=>{d||l?cn():(c("statusCard").classList.add("hidden"),c("statusBackdrop").classList.add("hidden"))}),c("btnCancel").addEventListener("click",()=>{cn()}),c("copyAddr").addEventListener("click",()=>U("Address",c("addr").textContent)),null==(ln=c("toggleAddrQr"))||ln.addEventListener("click",()=>{var n;String((null==(n=c("addr"))?void 0:n.textContent)||"").trim()&&(M(""),A(!m))}),null==(un=c("toggleSecretQr"))||un.addEventListener("click",()=>{y=!y;const n=c("secretQrPanel"),t=c("secretQrWrap"),r=c("secretQr"),e=c("toggleSecretQr"),o=c("secretQrPass"),s=c("secretQrScanWrap"),i=c("secretQrVideo"),a=c("btnSecretQrScan"),d=c("btnSecretQr");if(n&&n.classList.toggle("hidden",!y),e&&(e.textContent=y?"Hide QR":"QR"),!y)return B(),s&&s.classList.add("hidden"),i&&(i.srcObject=null),a&&(a.textContent="Scan"),t&&t.classList.add("hidden"),r&&r.replaceChildren(),void(o&&(o.value=""));t&&t.classList.add("hidden"),r&&r.replaceChildren(),d&&(d.disabled=!f),o&&(o.value="",o.focus())}),null==(fn=c("btnSecretQr"))||fn.addEventListener("click",()=>{f&&k()}),null==(hn=c("btnSecretQrScan"))||hn.addEventListener("click",()=>{!function(){const n=c("secretQrScanWrap"),t=c("btnSecretQrScan"),r=c("secretQrVideo");if(n){if(b)return B(),n.classList.add("hidden"),r&&(r.srcObject=null),void(t&&(t.textContent="Scan"));P().catch(e=>{B(),n.classList.add("hidden"),r&&(r.srcObject=null),t&&(t.textContent="Scan"),showModal("Scan error",String((null==e?void 0:e.message)||e),"error")})}}()}),null==(pn=c("btnSecretQrDecrypt"))||pn.addEventListener("click",()=>{F()}),c("toggleSecret").addEventListener("click",()=>{f&&I(!p)}),c("copySec").addEventListener("click",()=>{p&&U(h||"Secret",f||"")}),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&T()}),window.addEventListener("pagehide",()=>T()),window.addEventListener("beforeunload",()=>T()),c("btnGenerate").addEventListener("click",async()=>{try{an(),$();const n=String(c("outputKind").value||"priv");if("pickWords"===n)return;const e=t(c("prefix").value),o=t(c("suffix").value);if(!e&&!o)return D("‚ö†Ô∏è Enter a prefix or suffix first",{mode:"status"}),void H();e&&r(e),o&&r(o);const s=Number(c("seedLen").value||12),l="mnemonic"===n?await i():null;c("btnGenerate").disabled=!0,c("btnGenerate").textContent="Generating‚Ä¶",W({title:"Working‚Ä¶",spinner:!0});const u=Math.random().toString(16).slice(2),f=performance.now();let h=0;const p=e.length+o.length,m=K(p),w="mnemonic"===n?1:Math.max(1,Math.min(4,(navigator.hardwareConcurrency||2)-1||1)),y=[];d={runId:u,startedAt:f,workers:y,outputKind:n},Q();const x=()=>{const t=(performance.now()-f)/1e3,r=h/Math.max(t,.001),e=m?m/Math.max(r,.001):null,o=[];o.push("Searching‚Ä¶"),o.push(""),o.push(`Attempts: ${j(h)}`),o.push(`Rate: ~${j(r)}/${"mnemonic"===n?"sec (mnemonics)":"sec (keys)"}`),o.push(`Time: ${t.toFixed(1)}s`),p>0&&o.push(`Estimated: ${e?function(n){if(!Number.isFinite(n)||n<0)return"unknown";if(n<60)return n.toFixed(1)+"s";const t=n/60;if(t<60)return t.toFixed(1)+"m";const r=t/60;return r<48?r.toFixed(2)+"h":(r/24).toFixed(2)+"d"}(e):`~(32^${p} / rate)`}`),D(o.join("\n"),{mode:"status"})};c("statusCard").classList.remove("hidden"),D("Starting‚Ä¶",{mode:"status"});for(let t=0;t<w;t++){const t=a();t.onmessage=n=>{const t=n.data;!d||(null==t?void 0:t.runId)!==d.runId||("progress"===t.type?(h+=t.attempts,x()):"found"===t.type?(h+=t.attempts||0,an(),x(),G({address:t.address,secret:t.secret,secretLabel:t.secretLabel}),M(`Found in ${j(h)} attempts`),c("btnGenerate").disabled=!1,c("btnGenerate").textContent="Generate Again"):"error"===t.type&&(an(),D("‚ùå Error: "+t.error,{mode:"status"}),c("btnGenerate").disabled=!1,c("btnGenerate").textContent="Try Again"))},t.onerror=()=>{d&&(an(),D("‚ùå Error: worker failed.",{mode:"status"}),c("btnGenerate").disabled=!1,c("btnGenerate").textContent="Try Again")},y.push(t),t.postMessage({runId:u,prefix:e,suffix:o,outputKind:n,wordCount:s,wordlist:l})}}catch(n){an(),D("‚ùå "+String((null==n?void 0:n.message)||n),{mode:"status"}),c("btnGenerate").disabled=!1,c("btnGenerate").textContent="Try Again"}}),function(){const n=String(window.location.hash||"");if(!n||n.length<2)return!1;const t=new URLSearchParams(n.startsWith("#")?n.slice(1):n).get("venc");if(!t)return!1;let r="";try{r=(new TextDecoder).decode(v(t))}catch{return D("‚ùå Invalid payload in URL",{mode:"status"}),!0}try{history.replaceState(null,"",window.location.href.split("#")[0])}catch{}(function(n){var t;W({title:"Decrypt",spinner:!1}),_("result"),c("statusCard").classList.remove("hidden"),c("statusBackdrop").classList.remove("hidden"),f=null,h="Secret",I(!1),c("addr").textContent="",L(),c("secLabel").textContent="Decrypt",c("secret").textContent="",c("copySec")&&(c("copySec").disabled=!0),c("toggleSecret")&&(c("toggleSecret").disabled=!0),y=!0,null==(t=c("secretQrPanel"))||t.classList.remove("hidden"),c("toggleSecretQr")&&(c("toggleSecretQr").textContent="Hide QR"),c("btnSecretQr")&&(c("btnSecretQr").disabled=!0);const r=c("secretQrCiphertext");r&&(r.value=String(n||"").trim());const e=c("secretQrPass");e&&e.focus(),M("‚úì Payload loaded ‚Äî enter password to decrypt"),N(),Q()})(r)}(),dn(),async function(){Y="loading",O=[],sn(""),en(),on();try{O=await i(),Y="ready"}catch(n){Y="error",D("‚ùå "+String((null==n?void 0:n.message)||n),{mode:"status"})}sn(c("wordSearch").value),rn()}(),V()</script></head><body><div class="app"><header><h1>Bitcoin Address Creator</h1><p class="subtitle">Taproot address generator (bc1p‚Ä¶)</p></header><div class="content"><div class="card"><div class="step" id="patternCharsetStep"><div class="step-title"><span class="step-num">1</span>Choose Your Pattern</div><div class="helper">Use only these characters (bech32 charset):</div><div class="chars-compact">q p z r y 9 x 8 g f 2 t v d w 0 s 3 j n 5 4 k h c e 6 m u a 7 l</div></div><div class="step"><div class="step-title"><span class="step-num">2</span>Enter Pattern</div><div class="input-row"><div class="input-wrap"><label for="prefix">Start (prefix)</label> <input autocomplete="off" id="prefix" placeholder="sam" maxlength="12"></div><div class="input-wrap"><label for="suffix">End (suffix)</label> <input autocomplete="off" id="suffix" placeholder="2026" maxlength="12"></div></div><div class="input-row"><div class="input-wrap"><label for="outputKind">Mode</label> <select id="outputKind"><option value="priv">Private key (fast)</option><option value="mnemonic">Random seed phrase (slower)</option><option value="pickWords">Pick seed words</option></select></div><div class="input-wrap" id="seedLenWrap"><label for="seedLen">Seed length</label> <select id="seedLen"><option value="12">12 words</option><option value="24">24 words</option></select></div></div><div class="preview"><div class="preview-label">Preview</div><div class="preview-addr"><span class="base">bc1p</span><span class="prefix" id="prevPre"></span><span class="wild">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><span class="suffix" id="prevSuf"></span></div></div><div class="hidden difficulty" id="difficulty"><div class="diff-icon" id="diffIcon">‚è±Ô∏è</div><div class="diff-text" id="diffText"></div></div><div class="hidden word-picker" id="wordPickerWrap"><div class="helper" style="margin-bottom:10px">Tap words to build a seed phrase (then derive the first Taproot address). Note: prefix/suffix vanity matching is not available in this mode.</div><div class="empty word-selected" id="selectedWords"></div><div class="word-count" id="wordCount">0 / 12 words selected</div><div class="input-row single" style="margin-top:12px"><div class="input-wrap"><label for="wordSearch">Search</label> <input autocomplete="off" id="wordSearch" placeholder="type to filter‚Ä¶"></div></div><div class="word-grid" id="wordGrid"></div><div class="word-actions"><button class="btn-secondary btn-clear" id="btnClearWords" type="button">Clear</button> <button class="btn-secondary btn-derive" id="btnDeriveAddress" type="button" disabled="disabled">Derive</button></div></div></div><div class="step"><div class="step-title"><span class="step-num">3</span>Generate</div><button class="btn" id="btnGenerate">Start Generation</button></div></div><div class="hidden" id="statusBackdrop"></div><div class="hidden card" id="statusCard"><div class="result-header" style="margin-bottom:12px"><div class="step-title" style="margin-bottom:0"><span class="spinner" id="statusSpinner"></span><span id="statusTitle">Working‚Ä¶</span></div><button class="btn-close" id="closeStatus" type="button" aria-label="Close">√ó</button></div><div class="modal-body"><div id="statusView"><div class="status" id="status"></div></div><div class="hidden" id="resultView"><div class="hidden result-note status" id="resultNote"></div><div class="result-item"><div class="result-header"><span class="result-label">Your Address</span><div style="display:inline-flex;gap:8px;align-items:center"><button class="btn-copy" id="toggleAddrQr" type="button">QR</button> <button class="btn-copy" id="copyAddr" type="button">Copy</button></div></div><div class="result-value result-value--addr" id="addr"></div><div class="hidden qr-wrap" id="addrQrWrap"><div id="addrQr"></div></div></div><div class="result-item"><div class="result-header"><span class="result-label" id="secLabel">Private Key</span><div style="display:inline-flex;gap:8px;align-items:center"><button class="btn-copy" id="toggleSecret" type="button">Reveal</button> <button class="btn-copy" id="toggleSecretQr" type="button">QR</button> <button class="btn-copy" id="copySec" type="button" disabled="disabled">Copy</button></div></div><div class="result-value" id="secret"></div><div class="hidden" id="secretQrPanel" style="margin-top:10px"><div class="helper" style="margin-bottom:10px">The encrypted QR is a link that opens this app and auto-loads the encrypted payload. Enter your password to decrypt locally.</div><div class="input-row single" style="margin-top:10px;margin-bottom:10px"><div class="input-wrap"><label for="secretQrPass">Password (encrypt QR)</label> <input autocomplete="new-password" id="secretQrPass" placeholder="Enter a password" type="password"></div></div><div class="result-header" style="margin-bottom:6px"><span class="result-label">Encrypted QR</span> <button class="btn-copy" id="btnSecretQr" type="button">Generate</button></div><div class="hidden qr-wrap" id="secretQrWrap"><div id="secretQr"></div></div><div class="input-row single" style="margin-top:12px;margin-bottom:10px"><div class="input-wrap"><label for="secretQrCiphertext">Decrypt scanned text</label> <textarea id="secretQrCiphertext" placeholder="Paste scanned text starting with VANITY_ENC_V1‚Ä¶" rows="5"></textarea></div></div><div class="result-header" style="margin-bottom:6px"><span class="result-label">Decrypted (local)</span><div style="display:inline-flex;gap:8px;align-items:center"><button class="btn-copy" id="btnSecretQrScan" type="button">Scan</button> <button class="btn-copy" id="btnSecretQrDecrypt" type="button">Decrypt</button></div></div><div class="hidden scan-wrap" id="secretQrScanWrap"><video id="secretQrVideo" playsinline></video></div><div class="hidden result-value" id="secretQrPlain"></div></div></div><div class="info">üîí Never share your private key or seed phrase. Anyone with it can spend your Bitcoin. Import it into your wallet app and back it up ‚Äî do not lose it.</div></div></div><div class="word-actions" id="statusActions" style="grid-template-columns:1fr"><button class="btn-secondary btn-clear" id="btnCancel" type="button" disabled="disabled">Cancel</button></div></div></div></div><script type="text/plain" id="embeddedBip39Wordlist"></script><script defer="defer" referrerpolicy="no-referrer" src="/content/6f3ff06fb6414bf40c1dac14c3a78fd3979476467cf8a0e5f107c79e9455fc02i0"></script></body></html>